<!DOCTYPE html>
<html>
    <head>
        <title>API Key</title>
        <meta charset="UTF-8">
        <meta name="Viewpoint" content="width=device-width, initial-scale=1.0">
    </head>
<body>
      <div>Please enter a valid API key.</div>
      <form id="apikeyForm">
        <input type="text" id="apikey" name="apikey" required />
        <button id="submitApikey"type=">Submit">submit</button>
      </form>


      <script>
        let rootPath = "https://mysite. itvarsity.org/api/ContactBook/";
        document.getElementById("apikeyform").addEventListener('submit', setApikey);

        function setApikey(e){
            e.preventDefault();
            let apikey = document.getElementById("apikey").value;
            fetch(rootPath + "controller/api-key/?api-key=/?apikey=" + encodeURTComponent(apikey))
             .then(function(response) {
                 return response.text();
             })
            .then(function (data) {
                if (data == "1") {
                    localStorage.setItem("apikey", apikey);
                    window.location.href ="index.html";
                } else {
                    alert("Invalid API key entered! " + data);
                }
            })
            .catch(function(error) {
                alert("Error verifying API key.");
                console.error(erroe);
            });
        }
      </script>
</body>
</html>
